{
  "version": 3,
  "sources": ["../../balanced-match/index.js", "../../src/internal/utils/dom.ts", "../../src/internal/utils/node-belongs.ts"],
  "sourcesContent": ["'use strict';\nmodule.exports = balanced;\nfunction balanced(a, b, str) {\n  if (a instanceof RegExp) a = maybeMatch(a, str);\n  if (b instanceof RegExp) b = maybeMatch(b, str);\n\n  var r = range(a, b, str);\n\n  return r && {\n    start: r[0],\n    end: r[1],\n    pre: str.slice(0, r[0]),\n    body: str.slice(r[0] + a.length, r[1]),\n    post: str.slice(r[1] + b.length)\n  };\n}\n\nfunction maybeMatch(reg, str) {\n  var m = str.match(reg);\n  return m ? m[0] : null;\n}\n\nbalanced.range = range;\nfunction range(a, b, str) {\n  var begs, beg, left, right, result;\n  var ai = str.indexOf(a);\n  var bi = str.indexOf(b, ai + 1);\n  var i = ai;\n\n  if (ai >= 0 && bi > 0) {\n    if(a===b) {\n      return [ai, bi];\n    }\n    begs = [];\n    left = str.length;\n\n    while (i >= 0 && !result) {\n      if (i == ai) {\n        begs.push(i);\n        ai = str.indexOf(a, i + 1);\n      } else if (begs.length == 1) {\n        result = [ begs.pop(), bi ];\n      } else {\n        beg = begs.pop();\n        if (beg < left) {\n          left = beg;\n          right = bi;\n        }\n\n        bi = str.indexOf(b, i + 1);\n      }\n\n      i = ai < bi && ai >= 0 ? ai : bi;\n    }\n\n    if (begs.length) {\n      result = [ left, right ];\n    }\n  }\n\n  return result;\n}\n", "// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport balanced from 'balanced-match';\n\nimport { findUpUntil } from '@cloudscape-design/component-toolkit/dom';\n\nexport function isContainingBlock(element: HTMLElement): boolean {\n  const computedStyle = getComputedStyle(element);\n  return (\n    (!!computedStyle.transform && computedStyle.transform !== 'none') ||\n    (!!computedStyle.perspective && computedStyle.perspective !== 'none') ||\n    (!!computedStyle.containerType && computedStyle.containerType !== 'normal') ||\n    computedStyle.contain?.split(' ').some(s => ['layout', 'paint', 'strict', 'content'].includes(s))\n  );\n}\n\n/**\n * Returns an element that is used to position the given element.\n * @see https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block\n */\nexport function getContainingBlock(startElement: HTMLElement): HTMLElement | null {\n  if (!startElement.parentElement) {\n    return null;\n  }\n\n  return findUpUntil(startElement.parentElement, isContainingBlock) as HTMLElement;\n}\n\n/*\n * Allows to find multiple elements in the page each according to a specific test function,\n * but traversing the DOM only once.\n */\n\nexport function findUpUntilMultiple({\n  startElement,\n  tests,\n}: {\n  startElement: HTMLElement;\n  tests: Record<string, (el: HTMLElement) => boolean>;\n}) {\n  const keys = Object.keys(tests);\n  const elements: Record<string, HTMLElement> = {};\n  let current: HTMLElement | null = startElement;\n  while (current && Object.keys(elements).length < keys.length) {\n    current = current.parentElement;\n    // If a component is used within an svg (i.e. as foreignObject), then it will\n    // have some ancestor nodes that are SVGElement. We want to skip those,\n    // as they have very different properties to HTMLElements.\n    while (current && !isHTMLElement(current)) {\n      current = (current as Element).parentElement;\n    }\n    for (const key of keys) {\n      if (!elements[key] && current && tests[key](current)) {\n        elements[key] = current;\n      }\n    }\n  }\n  return elements;\n}\n\nconst cssVariableExpression = /--.+?\\s*,\\s*(.+)/;\n\n/**\n * Parses a CSS color value that might contain CSS Custom Properties\n * and returns a value that will be understood by the browser, no matter of support level.\n * If the browser support CSS Custom Properties, the value will be return as is. Otherwise,\n * the fallback value will be extracted and returned instead.\n */\nexport function parseCssVariable(value: string) {\n  if (typeof window === 'undefined') {\n    return value;\n  }\n\n  if (window.CSS?.supports?.('color', 'var(--dummy, #000)') ?? false) {\n    return value;\n  }\n\n  const varIndex = value.lastIndexOf('var(');\n  if (varIndex === -1) {\n    return value;\n  }\n\n  const expr = balanced('(', ')', value.substr(varIndex));\n  if (!expr) {\n    return value;\n  }\n\n  const match = expr.body.match(cssVariableExpression);\n  return match ? match[1] : value;\n}\n\n// The instanceof Node/HTMLElement/SVGElement checks can fail if the target element\n// belongs to a different window than the respective type.\n\nexport function isNode(target: unknown): target is Node {\n  return (\n    target instanceof Node ||\n    (target !== null &&\n      typeof target === 'object' &&\n      'nodeType' in target &&\n      typeof target.nodeType === 'number' &&\n      'nodeName' in target &&\n      typeof target.nodeName === 'string' &&\n      'parentNode' in target &&\n      typeof target.parentNode === 'object')\n  );\n}\n\nexport function isHTMLElement(target: unknown): target is HTMLElement {\n  return (\n    target instanceof HTMLElement ||\n    (isNode(target) &&\n      target.nodeType === Node.ELEMENT_NODE &&\n      'style' in target &&\n      typeof target.style === 'object' &&\n      typeof target.ownerDocument === 'object' &&\n      !isSVGElement(target))\n  );\n}\n\nexport function isSVGElement(target: unknown): target is SVGElement {\n  return (\n    target instanceof SVGElement ||\n    (isNode(target) &&\n      target.nodeType === Node.ELEMENT_NODE &&\n      'ownerSVGElement' in target &&\n      typeof target.ownerSVGElement === 'object')\n  );\n}\n\nexport function documentHasFocus() {\n  // In JSDOM the hasFocus() always returns false which differs from the in-browser experience, see: https://github.com/jsdom/jsdom/issues/3794.\n  // Thus, when detecting JSDOM environment we return true here explicitly for the tests to work expectedly.\n  // The detection depends on the default userAgent set in JSDOM, see: https://github.com/jsdom/jsdom?tab=readme-ov-file#advanced-configuration.\n  const isJSDOM = typeof navigator !== 'undefined' && navigator.userAgent?.includes('jsdom');\n  return isJSDOM || (typeof document !== undefined && document.hasFocus());\n}\n", "// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { findUpUntil, nodeContains } from '@cloudscape-design/component-toolkit/dom';\n\nimport { isHTMLElement, isNode } from './dom';\n\n/**\n * Checks whether the given node (target) belongs to the container.\n * The function is similar to nodeContains but also accounts for dropdowns with expandToViewport=true.\n *\n * @param container Container node\n * @param target Node that is checked to be a descendant of the container\n */\nexport function nodeBelongs(container: Node | null, target: Node | EventTarget | null): boolean {\n  if (!isNode(target)) {\n    return false;\n  }\n  const portal = findUpUntil(\n    target as HTMLElement,\n    node => node === container || (isHTMLElement(node) && !!node.dataset.awsuiReferrerId)\n  );\n  if (portal && portal === container) {\n    // We found the container as a direct ancestor without a portal\n    return true;\n  }\n  const referrer = isHTMLElement(portal) ? document.getElementById(portal.dataset.awsuiReferrerId ?? '') : null;\n  return referrer ? nodeContains(container, referrer) : nodeContains(container, target);\n}\n"],
  "mappings": "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",
  "names": ["balanced", "balanced"]
}
